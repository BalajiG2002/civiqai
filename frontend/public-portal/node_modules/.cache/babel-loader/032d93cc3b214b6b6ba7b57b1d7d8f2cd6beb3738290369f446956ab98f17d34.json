{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\NISHANTH MEGAN\\\\civiqai\\\\frontend\\\\public-portal\\\\src\\\\pages\\\\ReportPage.jsx\",\n  _s = $RefreshSig$();\nimport { useState, useRef, useEffect, useCallback } from 'react';\nimport axios from 'axios';\nimport ThinkingSteps from '../components/ThinkingSteps';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst BASE = 'http://localhost:8000';\n\n// Simulates the agent pipeline steps in real time\nfunction buildSteps(phase) {\n  const all = [{\n    id: 'analyze',\n    label: 'Analyzing image with Gemini Vision',\n    detail: 'Identifying issue type, severity and road condition'\n  }, {\n    id: 'locate',\n    label: 'Geocoding location',\n    detail: 'Converting address to coordinates via Maps API'\n  }, {\n    id: 'ward',\n    label: 'Finding municipal ward',\n    detail: 'Reverse geocoding to get ward and zone'\n  }, {\n    id: 'search',\n    label: 'Searching municipal directory',\n    detail: 'Looking up responsible officer in Redis'\n  }, {\n    id: 'cluster',\n    label: 'Checking nearby complaints',\n    detail: 'Scanning 500m radius for similar issues'\n  }, {\n    id: 'dispatch',\n    label: 'Sending work order email',\n    detail: 'Dispatching to municipal department'\n  }, {\n    id: 'publish',\n    label: 'Publishing to public feed',\n    detail: 'Posting complaint on the portal'\n  }];\n  return all.map((s, i) => ({\n    ...s,\n    active: i <= phase,\n    status: i < phase ? 'done' : i === phase ? 'running' : 'analyzing'\n  }));\n}\nconst SUGGESTIONS = ['üöß Report a pothole', 'üíß Water pipe leaking', 'üóëÔ∏è Garbage not collected', 'üí° Streetlight not working', 'üåä Waterlogging issue'];\nexport default function ReportPage() {\n  _s();\n  const [messages, setMessages] = useState([]);\n  const [input, setInput] = useState('');\n  const [image, setImage] = useState(null);\n  const [preview, setPreview] = useState(null);\n  const [loading, setLoading] = useState(false);\n  const [phase, setPhase] = useState(-1);\n  const [started, setStarted] = useState(false);\n  const bottomRef = useRef(null);\n  const fileRef = useRef(null);\n  const timerRef = useRef(null);\n  useEffect(() => {\n    var _bottomRef$current;\n    (_bottomRef$current = bottomRef.current) === null || _bottomRef$current === void 0 ? void 0 : _bottomRef$current.scrollIntoView({\n      behavior: 'smooth'\n    });\n  }, [messages, phase]);\n\n  // Simulate step-by-step agent progress\n  const simulateSteps = useCallback(onDone => {\n    let step = 0;\n    setPhase(0);\n    timerRef.current = setInterval(() => {\n      step++;\n      if (step >= 7) {\n        clearInterval(timerRef.current);\n        setPhase(8); // all done\n        onDone();\n      } else {\n        setPhase(step);\n      }\n    }, 1400);\n  }, []);\n  const handleImage = e => {\n    const file = e.target.files[0];\n    if (!file) return;\n    setImage(file);\n    setPreview(URL.createObjectURL(file));\n  };\n  const handleSubmit = async text => {\n    const msg = text || input.trim();\n    if (!msg && !image) return;\n    setStarted(true);\n    setLoading(true);\n    setPhase(0);\n\n    // Add user message\n    setMessages(prev => [...prev, {\n      role: 'user',\n      text: msg,\n      image: preview\n    }]);\n    setInput('');\n    setPreview(null);\n\n    // Add thinking message\n    const thinkingId = Date.now();\n    setMessages(prev => [...prev, {\n      role: 'thinking',\n      id: thinkingId\n    }]);\n    try {\n      // Simulate steps while API call happens\n      const apiPromise = image ? submitWithImage(msg) : simulateChatOnly(msg);\n      simulateSteps(async () => {\n        const result = await apiPromise;\n        // Replace thinking with real response\n        setMessages(prev => prev.map(m => m.id === thinkingId ? {\n          role: 'assistant',\n          text: result\n        } : m));\n        setLoading(false);\n        setPhase(-1);\n        setImage(null);\n      });\n    } catch (err) {\n      setMessages(prev => prev.map(m => m.id === thinkingId ? {\n        role: 'assistant',\n        text: '‚ùå Something went wrong. Please try again.'\n      } : m));\n      setLoading(false);\n      setPhase(-1);\n    }\n  };\n  const submitWithImage = async location => {\n    const fd = new FormData();\n    fd.append('image', image);\n    fd.append('location', location || 'Chennai');\n    const {\n      data\n    } = await axios.post(`${BASE}/complaint`, fd, {\n      headers: {\n        'Content-Type': 'multipart/form-data'\n      }\n    });\n    return data.message || 'Complaint submitted successfully!';\n  };\n  const simulateChatOnly = async msg => {\n    await new Promise(r => setTimeout(r, 7000));\n    return `Your complaint about \"${msg}\" has been noted. Please attach a photo to complete the submission.`;\n  };\n\n  // Welcome screen\n  if (!started) return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"max-w-2xl mx-auto px-4 py-16 flex flex-col\\r items-center text-center\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"w-16 h-16 rounded-2xl bg-gradient-to-br\\r from-blue-600 to-purple-600 flex items-center\\r justify-center text-3xl mb-6 shadow-lg\",\n      children: \"\\uD83C\\uDFD9\\uFE0F\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 156,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"h1\", {\n      className: \"text-3xl font-bold text-white mb-2\",\n      children: \"Report a Civic Issue\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 161,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n      className: \"text-zinc-400 mb-10 max-w-md\",\n      children: \"Take a photo, share your location \\u2014 CiviqAI will analyze it and notify the right department automatically.\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 164,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"w-full max-w-xl\",\n      children: /*#__PURE__*/_jsxDEV(InputBar, {\n        input: input,\n        setInput: setInput,\n        image: image,\n        preview: preview,\n        fileRef: fileRef,\n        handleImage: handleImage,\n        onSubmit: handleSubmit,\n        loading: loading\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 171,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 170,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex flex-wrap gap-2 justify-center mt-6\",\n      children: SUGGESTIONS.map(s => /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => handleSubmit(s),\n        className: \"px-4 py-2 bg-zinc-900 border border-white/10\\r rounded-full text-sm text-zinc-400\\r hover:border-white/30 hover:text-white\\r transition-all\",\n        children: s\n      }, s, false, {\n        fileName: _jsxFileName,\n        lineNumber: 186,\n        columnNumber: 11\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 184,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 154,\n    columnNumber: 5\n  }, this);\n\n  // Chat view\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"max-w-2xl mx-auto px-4 flex flex-col\\r h-[calc(100vh-65px)]\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex-1 overflow-y-auto py-6 space-y-8\",\n      children: [messages.map((m, i) => {\n        var _m$text, _m$text2;\n        return /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [m.role === 'user' && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"mb-6\",\n            children: [m.image && /*#__PURE__*/_jsxDEV(\"img\", {\n              src: m.image,\n              alt: \"uploaded\",\n              className: \"w-full max-h-56 object-cover\\r rounded-2xl mb-3 border border-white/10\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 215,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"h2\", {\n              className: \"text-2xl font-bold text-white leading-tight\",\n              children: m.text\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 219,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 213,\n            columnNumber: 15\n          }, this), m.role === 'thinking' && phase >= 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"bg-zinc-900 border border-white/10\\r rounded-2xl p-5\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex items-center gap-2 mb-4\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"w-4 h-4 border-2 border-zinc-600\\r border-t-blue-400 rounded-full animate-spin\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 230,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"text-sm font-medium text-zinc-400\",\n                children: \"CiviqAI is processing your complaint...\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 232,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 229,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(ThinkingSteps, {\n              steps: buildSteps(phase)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 236,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 227,\n            columnNumber: 15\n          }, this), m.role === 'assistant' && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"space-y-3\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex items-center gap-2 mb-2\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"w-6 h-6 rounded-full bg-gradient-to-br\\r from-blue-500 to-purple-600 flex items-center\\r justify-center text-xs\",\n                children: \"\\uD83E\\uDD16\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 244,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"text-sm font-semibold text-white\",\n                children: \"CiviqAI\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 247,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 243,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"prose prose-invert text-zinc-200\\r text-base leading-relaxed max-w-none\",\n              children: /*#__PURE__*/_jsxDEV(\"p\", {\n                children: m.text\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 251,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 249,\n              columnNumber: 17\n            }, this), (_m$text = m.text) !== null && _m$text !== void 0 && _m$text.includes('submitted') || (_m$text2 = m.text) !== null && _m$text2 !== void 0 && _m$text2.includes('sent') ? /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"bg-green-500/10 border border-green-500/20\\r rounded-xl p-4 flex items-start gap-3\",\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"text-2xl\",\n                children: \"\\u2705\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 259,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                children: [/*#__PURE__*/_jsxDEV(\"p\", {\n                  className: \"text-green-400 font-semibold text-sm\",\n                  children: \"Complaint Submitted\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 261,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                  className: \"text-green-300/70 text-xs mt-0.5\",\n                  children: \"Your complaint is now live on the feed and the department has been notified.\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 264,\n                  columnNumber: 23\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 260,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 257,\n              columnNumber: 19\n            }, this) : null]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 242,\n            columnNumber: 15\n          }, this)]\n        }, i, true, {\n          fileName: _jsxFileName,\n          lineNumber: 209,\n          columnNumber: 11\n        }, this);\n      }), /*#__PURE__*/_jsxDEV(\"div\", {\n        ref: bottomRef\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 275,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 207,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"pb-4 pt-2 border-t border-white/10\",\n      children: /*#__PURE__*/_jsxDEV(InputBar, {\n        input: input,\n        setInput: setInput,\n        image: image,\n        preview: preview,\n        fileRef: fileRef,\n        handleImage: handleImage,\n        onSubmit: handleSubmit,\n        loading: loading\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 280,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 279,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 203,\n    columnNumber: 5\n  }, this);\n}\n\n// ‚îÄ‚îÄ Shared Input Bar ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n_s(ReportPage, \"O2QxzjEoZxJu6taYio/08zZaGHM=\");\n_c = ReportPage;\nfunction InputBar({\n  input,\n  setInput,\n  image,\n  preview,\n  fileRef,\n  handleImage,\n  onSubmit,\n  loading\n}) {\n  const handleKey = e => {\n    if (e.key === 'Enter' && !e.shiftKey) {\n      e.preventDefault();\n      onSubmit(input);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"bg-zinc-900 border border-white/10 rounded-2xl\\r overflow-hidden focus-within:border-white/30\\r transition-colors\",\n    children: [preview && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"px-4 pt-3\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"relative inline-block\",\n        children: [/*#__PURE__*/_jsxDEV(\"img\", {\n          src: preview,\n          alt: \"preview\",\n          className: \"h-20 w-32 object-cover rounded-xl\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 315,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => {},\n          className: \"absolute -top-1 -right-1 w-5 h-5 bg-zinc-700\\r rounded-full flex items-center justify-center\\r text-xs hover:bg-red-600 transition-colors\",\n          children: \"\\u2715\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 317,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 314,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 313,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex items-end gap-2 px-4 py-3\",\n      children: [/*#__PURE__*/_jsxDEV(\"textarea\", {\n        value: input,\n        onChange: e => setInput(e.target.value),\n        onKeyDown: handleKey,\n        placeholder: \"Describe the issue or share your location...\",\n        rows: 1,\n        className: \"flex-1 bg-transparent text-white text-sm\\r placeholder:text-zinc-600 resize-none focus:outline-none\\r max-h-32 overflow-y-auto\",\n        style: {\n          fieldSizing: 'content'\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 330,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex items-center gap-2 flex-shrink-0\",\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => fileRef.current.click(),\n          className: \"w-8 h-8 rounded-full flex items-center justify-center\\r text-zinc-500 hover:text-white hover:bg-white/10\\r transition-colors\",\n          title: \"Attach photo\",\n          children: /*#__PURE__*/_jsxDEV(\"svg\", {\n            className: \"w-5 h-5\",\n            fill: \"none\",\n            stroke: \"currentColor\",\n            viewBox: \"0 0 24 24\",\n            children: /*#__PURE__*/_jsxDEV(\"path\", {\n              strokeLinecap: \"round\",\n              strokeLinejoin: \"round\",\n              strokeWidth: 1.5,\n              d: \"M15.172 7l-6.586 6.586a2 2 0 102.828 2.828l6.414-6.586a4 4 0 00-5.656-5.656l-6.415 6.585a6 6 0 108.486 8.486L20.5 13\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 355,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 353,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 346,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          ref: fileRef,\n          type: \"file\",\n          accept: \"image/*\",\n          className: \"hidden\",\n          onChange: handleImage\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 360,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => onSubmit(input),\n          disabled: loading || !input.trim() && !image,\n          className: \"w-8 h-8 rounded-full bg-white flex items-center\\r justify-center disabled:opacity-30 disabled:cursor-not-allowed\\r hover:bg-zinc-200 transition-colors\",\n          children: loading ? /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"w-4 h-4 border-2 border-zinc-400\\r border-t-zinc-800 rounded-full animate-spin\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 372,\n            columnNumber: 17\n          }, this) : /*#__PURE__*/_jsxDEV(\"svg\", {\n            className: \"w-4 h-4 text-black\",\n            fill: \"none\",\n            stroke: \"currentColor\",\n            viewBox: \"0 0 24 24\",\n            children: /*#__PURE__*/_jsxDEV(\"path\", {\n              strokeLinecap: \"round\",\n              strokeLinejoin: \"round\",\n              strokeWidth: 2,\n              d: \"M5 12h14M12 5l7 7-7 7\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 376,\n              columnNumber: 19\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 374,\n            columnNumber: 17\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 364,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 343,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 329,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 307,\n    columnNumber: 5\n  }, this);\n}\n_c2 = InputBar;\nvar _c, _c2;\n$RefreshReg$(_c, \"ReportPage\");\n$RefreshReg$(_c2, \"InputBar\");","map":{"version":3,"names":["useState","useRef","useEffect","useCallback","axios","ThinkingSteps","jsxDEV","_jsxDEV","BASE","buildSteps","phase","all","id","label","detail","map","s","i","active","status","SUGGESTIONS","ReportPage","_s","messages","setMessages","input","setInput","image","setImage","preview","setPreview","loading","setLoading","setPhase","started","setStarted","bottomRef","fileRef","timerRef","_bottomRef$current","current","scrollIntoView","behavior","simulateSteps","onDone","step","setInterval","clearInterval","handleImage","e","file","target","files","URL","createObjectURL","handleSubmit","text","msg","trim","prev","role","thinkingId","Date","now","apiPromise","submitWithImage","simulateChatOnly","result","m","err","location","fd","FormData","append","data","post","headers","message","Promise","r","setTimeout","className","children","fileName","_jsxFileName","lineNumber","columnNumber","InputBar","onSubmit","onClick","_m$text","_m$text2","src","alt","steps","includes","ref","_c","handleKey","key","shiftKey","preventDefault","value","onChange","onKeyDown","placeholder","rows","style","fieldSizing","click","title","fill","stroke","viewBox","strokeLinecap","strokeLinejoin","strokeWidth","d","type","accept","disabled","_c2","$RefreshReg$"],"sources":["C:/Users/NISHANTH MEGAN/civiqai/frontend/public-portal/src/pages/ReportPage.jsx"],"sourcesContent":["import { useState, useRef, useEffect, useCallback } from 'react';\r\nimport axios from 'axios';\r\nimport ThinkingSteps from '../components/ThinkingSteps';\r\n\r\nconst BASE = 'http://localhost:8000';\r\n\r\n// Simulates the agent pipeline steps in real time\r\nfunction buildSteps(phase) {\r\n  const all = [\r\n    { id: 'analyze',  label: 'Analyzing image with Gemini Vision',\r\n      detail: 'Identifying issue type, severity and road condition' },\r\n    { id: 'locate',   label: 'Geocoding location',\r\n      detail: 'Converting address to coordinates via Maps API' },\r\n    { id: 'ward',     label: 'Finding municipal ward',\r\n      detail: 'Reverse geocoding to get ward and zone' },\r\n    { id: 'search',   label: 'Searching municipal directory',\r\n      detail: 'Looking up responsible officer in Redis' },\r\n    { id: 'cluster',  label: 'Checking nearby complaints',\r\n      detail: 'Scanning 500m radius for similar issues' },\r\n    { id: 'dispatch', label: 'Sending work order email',\r\n      detail: 'Dispatching to municipal department' },\r\n    { id: 'publish',  label: 'Publishing to public feed',\r\n      detail: 'Posting complaint on the portal' },\r\n  ];\r\n\r\n  return all.map((s, i) => ({\r\n    ...s,\r\n    active: i <= phase,\r\n    status: i < phase  ? 'done'\r\n          : i === phase ? 'running'\r\n          : 'analyzing'\r\n  }));\r\n}\r\n\r\nconst SUGGESTIONS = [\r\n  'üöß Report a pothole',\r\n  'üíß Water pipe leaking',\r\n  'üóëÔ∏è Garbage not collected',\r\n  'üí° Streetlight not working',\r\n  'üåä Waterlogging issue',\r\n];\r\n\r\nexport default function ReportPage() {\r\n  const [messages, setMessages] = useState([]);\r\n  const [input,    setInput]    = useState('');\r\n  const [image,    setImage]    = useState(null);\r\n  const [preview,  setPreview]  = useState(null);\r\n  const [loading,  setLoading]  = useState(false);\r\n  const [phase,    setPhase]    = useState(-1);\r\n  const [started,  setStarted]  = useState(false);\r\n  const bottomRef  = useRef(null);\r\n  const fileRef    = useRef(null);\r\n  const timerRef   = useRef(null);\r\n\r\n  useEffect(() => {\r\n    bottomRef.current?.scrollIntoView({ behavior: 'smooth' });\r\n  }, [messages, phase]);\r\n\r\n  // Simulate step-by-step agent progress\r\n  const simulateSteps = useCallback((onDone) => {\r\n    let step = 0;\r\n    setPhase(0);\r\n    timerRef.current = setInterval(() => {\r\n      step++;\r\n      if (step >= 7) {\r\n        clearInterval(timerRef.current);\r\n        setPhase(8); // all done\r\n        onDone();\r\n      } else {\r\n        setPhase(step);\r\n      }\r\n    }, 1400);\r\n  }, []);\r\n\r\n  const handleImage = (e) => {\r\n    const file = e.target.files[0];\r\n    if (!file) return;\r\n    setImage(file);\r\n    setPreview(URL.createObjectURL(file));\r\n  };\r\n\r\n  const handleSubmit = async (text) => {\r\n    const msg = text || input.trim();\r\n    if (!msg && !image) return;\r\n\r\n    setStarted(true);\r\n    setLoading(true);\r\n    setPhase(0);\r\n\r\n    // Add user message\r\n    setMessages(prev => [...prev, {\r\n      role:    'user',\r\n      text:    msg,\r\n      image:   preview\r\n    }]);\r\n    setInput('');\r\n    setPreview(null);\r\n\r\n    // Add thinking message\r\n    const thinkingId = Date.now();\r\n    setMessages(prev => [...prev, {\r\n      role: 'thinking',\r\n      id:   thinkingId\r\n    }]);\r\n\r\n    try {\r\n      // Simulate steps while API call happens\r\n      const apiPromise = image\r\n        ? submitWithImage(msg)\r\n        : simulateChatOnly(msg);\r\n\r\n      simulateSteps(async () => {\r\n        const result = await apiPromise;\r\n        // Replace thinking with real response\r\n        setMessages(prev => prev.map(m =>\r\n          m.id === thinkingId\r\n            ? { role: 'assistant', text: result }\r\n            : m\r\n        ));\r\n        setLoading(false);\r\n        setPhase(-1);\r\n        setImage(null);\r\n      });\r\n\r\n    } catch (err) {\r\n      setMessages(prev => prev.map(m =>\r\n        m.id === thinkingId\r\n          ? { role: 'assistant',\r\n              text: '‚ùå Something went wrong. Please try again.' }\r\n          : m\r\n      ));\r\n      setLoading(false);\r\n      setPhase(-1);\r\n    }\r\n  };\r\n\r\n  const submitWithImage = async (location) => {\r\n    const fd = new FormData();\r\n    fd.append('image',    image);\r\n    fd.append('location', location || 'Chennai');\r\n    const { data } = await axios.post(`${BASE}/complaint`, fd, {\r\n      headers: { 'Content-Type': 'multipart/form-data' }\r\n    });\r\n    return data.message || 'Complaint submitted successfully!';\r\n  };\r\n\r\n  const simulateChatOnly = async (msg) => {\r\n    await new Promise(r => setTimeout(r, 7000));\r\n    return `Your complaint about \"${msg}\" has been noted. Please attach a photo to complete the submission.`;\r\n  };\r\n\r\n  // Welcome screen\r\n  if (!started) return (\r\n    <div className=\"max-w-2xl mx-auto px-4 py-16 flex flex-col\r\n                    items-center text-center\">\r\n      <div className=\"w-16 h-16 rounded-2xl bg-gradient-to-br\r\n                      from-blue-600 to-purple-600 flex items-center\r\n                      justify-center text-3xl mb-6 shadow-lg\">\r\n        üèôÔ∏è\r\n      </div>\r\n      <h1 className=\"text-3xl font-bold text-white mb-2\">\r\n        Report a Civic Issue\r\n      </h1>\r\n      <p className=\"text-zinc-400 mb-10 max-w-md\">\r\n        Take a photo, share your location ‚Äî CiviqAI will analyze it\r\n        and notify the right department automatically.\r\n      </p>\r\n\r\n      {/* Main input */}\r\n      <div className=\"w-full max-w-xl\">\r\n        <InputBar\r\n          input={input}\r\n          setInput={setInput}\r\n          image={image}\r\n          preview={preview}\r\n          fileRef={fileRef}\r\n          handleImage={handleImage}\r\n          onSubmit={handleSubmit}\r\n          loading={loading}\r\n        />\r\n      </div>\r\n\r\n      {/* Suggestions */}\r\n      <div className=\"flex flex-wrap gap-2 justify-center mt-6\">\r\n        {SUGGESTIONS.map(s => (\r\n          <button\r\n            key={s}\r\n            onClick={() => handleSubmit(s)}\r\n            className=\"px-4 py-2 bg-zinc-900 border border-white/10\r\n                       rounded-full text-sm text-zinc-400\r\n                       hover:border-white/30 hover:text-white\r\n                       transition-all\"\r\n          >\r\n            {s}\r\n          </button>\r\n        ))}\r\n      </div>\r\n    </div>\r\n  );\r\n\r\n  // Chat view\r\n  return (\r\n    <div className=\"max-w-2xl mx-auto px-4 flex flex-col\r\n                    h-[calc(100vh-65px)]\">\r\n\r\n      {/* Messages */}\r\n      <div className=\"flex-1 overflow-y-auto py-6 space-y-8\">\r\n        {messages.map((m, i) => (\r\n          <div key={i}>\r\n\r\n            {/* User message */}\r\n            {m.role === 'user' && (\r\n              <div className=\"mb-6\">\r\n                {m.image && (\r\n                  <img src={m.image} alt=\"uploaded\"\r\n                       className=\"w-full max-h-56 object-cover\r\n                                  rounded-2xl mb-3 border border-white/10\"/>\r\n                )}\r\n                <h2 className=\"text-2xl font-bold text-white leading-tight\">\r\n                  {m.text}\r\n                </h2>\r\n              </div>\r\n            )}\r\n\r\n            {/* Thinking / Processing */}\r\n            {m.role === 'thinking' && phase >= 0 && (\r\n              <div className=\"bg-zinc-900 border border-white/10\r\n                              rounded-2xl p-5\">\r\n                <div className=\"flex items-center gap-2 mb-4\">\r\n                  <div className=\"w-4 h-4 border-2 border-zinc-600\r\n                                  border-t-blue-400 rounded-full animate-spin\"/>\r\n                  <span className=\"text-sm font-medium text-zinc-400\">\r\n                    CiviqAI is processing your complaint...\r\n                  </span>\r\n                </div>\r\n                <ThinkingSteps steps={buildSteps(phase)} />\r\n              </div>\r\n            )}\r\n\r\n            {/* Assistant response */}\r\n            {m.role === 'assistant' && (\r\n              <div className=\"space-y-3\">\r\n                <div className=\"flex items-center gap-2 mb-2\">\r\n                  <div className=\"w-6 h-6 rounded-full bg-gradient-to-br\r\n                                  from-blue-500 to-purple-600 flex items-center\r\n                                  justify-center text-xs\">ü§ñ</div>\r\n                  <span className=\"text-sm font-semibold text-white\">CiviqAI</span>\r\n                </div>\r\n                <div className=\"prose prose-invert text-zinc-200\r\n                                text-base leading-relaxed max-w-none\">\r\n                  <p>{m.text}</p>\r\n                </div>\r\n\r\n                {/* Success card */}\r\n                {m.text?.includes('submitted') ||\r\n                 m.text?.includes('sent') ? (\r\n                  <div className=\"bg-green-500/10 border border-green-500/20\r\n                                  rounded-xl p-4 flex items-start gap-3\">\r\n                    <span className=\"text-2xl\">‚úÖ</span>\r\n                    <div>\r\n                      <p className=\"text-green-400 font-semibold text-sm\">\r\n                        Complaint Submitted\r\n                      </p>\r\n                      <p className=\"text-green-300/70 text-xs mt-0.5\">\r\n                        Your complaint is now live on the feed and the\r\n                        department has been notified.\r\n                      </p>\r\n                    </div>\r\n                  </div>\r\n                ) : null}\r\n              </div>\r\n            )}\r\n          </div>\r\n        ))}\r\n        <div ref={bottomRef} />\r\n      </div>\r\n\r\n      {/* Sticky input */}\r\n      <div className=\"pb-4 pt-2 border-t border-white/10\">\r\n        <InputBar\r\n          input={input}\r\n          setInput={setInput}\r\n          image={image}\r\n          preview={preview}\r\n          fileRef={fileRef}\r\n          handleImage={handleImage}\r\n          onSubmit={handleSubmit}\r\n          loading={loading}\r\n        />\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n// ‚îÄ‚îÄ Shared Input Bar ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\r\nfunction InputBar({ input, setInput, image, preview, fileRef,\r\n                    handleImage, onSubmit, loading }) {\r\n\r\n  const handleKey = (e) => {\r\n    if (e.key === 'Enter' && !e.shiftKey) {\r\n      e.preventDefault();\r\n      onSubmit(input);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"bg-zinc-900 border border-white/10 rounded-2xl\r\n                    overflow-hidden focus-within:border-white/30\r\n                    transition-colors\">\r\n\r\n      {/* Image preview strip */}\r\n      {preview && (\r\n        <div className=\"px-4 pt-3\">\r\n          <div className=\"relative inline-block\">\r\n            <img src={preview} alt=\"preview\"\r\n                 className=\"h-20 w-32 object-cover rounded-xl\"/>\r\n            <button\r\n              onClick={() => { }}\r\n              className=\"absolute -top-1 -right-1 w-5 h-5 bg-zinc-700\r\n                         rounded-full flex items-center justify-center\r\n                         text-xs hover:bg-red-600 transition-colors\">\r\n              ‚úï\r\n            </button>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Text input */}\r\n      <div className=\"flex items-end gap-2 px-4 py-3\">\r\n        <textarea\r\n          value={input}\r\n          onChange={e => setInput(e.target.value)}\r\n          onKeyDown={handleKey}\r\n          placeholder=\"Describe the issue or share your location...\"\r\n          rows={1}\r\n          className=\"flex-1 bg-transparent text-white text-sm\r\n                     placeholder:text-zinc-600 resize-none focus:outline-none\r\n                     max-h-32 overflow-y-auto\"\r\n          style={{ fieldSizing: 'content' }}\r\n        />\r\n\r\n        {/* Action buttons */}\r\n        <div className=\"flex items-center gap-2 flex-shrink-0\">\r\n\r\n          {/* Attach photo */}\r\n          <button\r\n            onClick={() => fileRef.current.click()}\r\n            className=\"w-8 h-8 rounded-full flex items-center justify-center\r\n                       text-zinc-500 hover:text-white hover:bg-white/10\r\n                       transition-colors\"\r\n            title=\"Attach photo\"\r\n          >\r\n            <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\"\r\n                 viewBox=\"0 0 24 24\">\r\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\"\r\n                    strokeWidth={1.5}\r\n                    d=\"M15.172 7l-6.586 6.586a2 2 0 102.828 2.828l6.414-6.586a4 4 0 00-5.656-5.656l-6.415 6.585a6 6 0 108.486 8.486L20.5 13\"/>\r\n            </svg>\r\n          </button>\r\n          <input ref={fileRef} type=\"file\" accept=\"image/*\"\r\n                 className=\"hidden\" onChange={handleImage} />\r\n\r\n          {/* Submit */}\r\n          <button\r\n            onClick={() => onSubmit(input)}\r\n            disabled={loading || (!input.trim() && !image)}\r\n            className=\"w-8 h-8 rounded-full bg-white flex items-center\r\n                       justify-center disabled:opacity-30 disabled:cursor-not-allowed\r\n                       hover:bg-zinc-200 transition-colors\"\r\n          >\r\n            {loading\r\n              ? <div className=\"w-4 h-4 border-2 border-zinc-400\r\n                                border-t-zinc-800 rounded-full animate-spin\"/>\r\n              : <svg className=\"w-4 h-4 text-black\" fill=\"none\"\r\n                     stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\"\r\n                        strokeWidth={2} d=\"M5 12h14M12 5l7 7-7 7\"/>\r\n                </svg>\r\n            }\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}