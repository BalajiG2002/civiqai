{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\NISHANTH MEGAN\\\\civiqai\\\\frontend\\\\public-portal\\\\src\\\\pages\\\\ReportPage.jsx\",\n  _s = $RefreshSig$();\nimport { useState, useRef, useEffect, useCallback } from 'react';\nimport axios from 'axios';\nimport ThinkingSteps from '../components/ThinkingSteps';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst BASE = process.env.REACT_APP_API_URL || 'http://localhost:8080';\n\n// Simulates the agent pipeline steps in real time\nfunction buildSteps(phase, hasImage) {\n  const imageSteps = [{\n    id: 'analyze',\n    label: 'Analyzing image with Gemini Vision',\n    detail: 'Identifying issue type, severity and road condition'\n  }, {\n    id: 'locate',\n    label: 'Geocoding location',\n    detail: 'Converting address to coordinates via Maps API'\n  }, {\n    id: 'ward',\n    label: 'Finding municipal ward',\n    detail: 'Reverse geocoding to get ward and zone'\n  }, {\n    id: 'search',\n    label: 'Searching municipal directory',\n    detail: 'Looking up responsible officer in Redis'\n  }, {\n    id: 'cluster',\n    label: 'Checking nearby complaints',\n    detail: 'Scanning 500m radius for similar issues'\n  }, {\n    id: 'dispatch',\n    label: 'Sending work order email',\n    detail: 'Dispatching to municipal department'\n  }, {\n    id: 'publish',\n    label: 'Publishing to public feed',\n    detail: 'Posting complaint on the portal'\n  }];\n  const chatSteps = [{\n    id: 'processing',\n    label: 'Processing your query',\n    detail: 'Understanding your question'\n  }, {\n    id: 'search',\n    label: 'Searching complaint database',\n    detail: 'Looking up relevant data'\n  }, {\n    id: 'analyze',\n    label: 'Analyzing trends and patterns',\n    detail: 'Generating insights'\n  }, {\n    id: 'respond',\n    label: 'Preparing response',\n    detail: 'Formatting answer for you'\n  }];\n  const all = hasImage ? imageSteps : chatSteps;\n  return all.map((s, i) => ({\n    ...s,\n    active: i <= phase,\n    status: i < phase ? 'done' : i === phase ? 'running' : 'analyzing'\n  }));\n}\nconst SUGGESTIONS = ['üöß Report a pothole', 'üíß Water pipe leaking', 'üóëÔ∏è Garbage not collected', 'üí° Streetlight not working', 'üåä Waterlogging issue'];\nexport default function ReportPage() {\n  _s();\n  const [messages, setMessages] = useState([]);\n  const [input, setInput] = useState('');\n  const [image, setImage] = useState(null);\n  const [preview, setPreview] = useState(null);\n  const [loading, setLoading] = useState(false);\n  const [phase, setPhase] = useState(-1);\n  const [started, setStarted] = useState(false);\n  const [hasImage, setHasImage] = useState(false);\n  const [gpsCoords, setGpsCoords] = useState(null); // {lat, lng}\n  const [gpsLoading, setGpsLoading] = useState(false);\n  const bottomRef = useRef(null);\n  const fileRef = useRef(null);\n  const timerRef = useRef(null);\n  useEffect(() => {\n    var _bottomRef$current;\n    (_bottomRef$current = bottomRef.current) === null || _bottomRef$current === void 0 ? void 0 : _bottomRef$current.scrollIntoView({\n      behavior: 'smooth'\n    });\n  }, [messages, phase]);\n\n  // Handle paste event to capture images from clipboard\n  useEffect(() => {\n    const handlePaste = e => {\n      var _e$clipboardData;\n      const items = (_e$clipboardData = e.clipboardData) === null || _e$clipboardData === void 0 ? void 0 : _e$clipboardData.items;\n      if (!items) return;\n      for (const item of items) {\n        if (item.type.startsWith('image/')) {\n          e.preventDefault();\n          const file = item.getAsFile();\n          if (file) {\n            setImage(file);\n            setPreview(URL.createObjectURL(file));\n          }\n          break;\n        }\n      }\n    };\n    document.addEventListener('paste', handlePaste);\n    return () => document.removeEventListener('paste', handlePaste);\n  }, []);\n\n  // Simulate step-by-step agent progress\n  const simulateSteps = useCallback((onDone, isImageSubmission) => {\n    let step = 0;\n    const maxSteps = isImageSubmission ? 7 : 4;\n    setPhase(0);\n    timerRef.current = setInterval(() => {\n      step++;\n      if (step >= maxSteps) {\n        clearInterval(timerRef.current);\n        setPhase(maxSteps + 1); // all done\n        onDone();\n      } else {\n        setPhase(step);\n      }\n    }, 1400);\n  }, []);\n\n  // ‚îÄ‚îÄ GPS: Get current location ‚îÄ‚îÄ\n  const handleGps = useCallback(() => {\n    if (!navigator.geolocation) {\n      alert('Geolocation is not supported by your browser');\n      return;\n    }\n    setGpsLoading(true);\n    navigator.geolocation.getCurrentPosition(async pos => {\n      const {\n        latitude,\n        longitude\n      } = pos.coords;\n      setGpsCoords({\n        lat: latitude,\n        lng: longitude\n      });\n      try {\n        const {\n          data\n        } = await axios.get(`${BASE}/reverse-geocode?lat=${latitude}&lng=${longitude}`);\n        const addr = data.formatted_address || data.area || `${latitude}, ${longitude}`;\n        setInput(prev => prev ? prev : addr);\n      } catch {\n        setInput(`${latitude.toFixed(6)}, ${longitude.toFixed(6)}`);\n      }\n      setGpsLoading(false);\n    }, err => {\n      console.error('GPS error', err);\n      alert('Could not get your location. Please allow location access.');\n      setGpsLoading(false);\n    }, {\n      enableHighAccuracy: true,\n      timeout: 10000\n    });\n  }, []);\n  const handleImage = e => {\n    const file = e.target.files[0];\n    if (!file) return;\n    setImage(file);\n    setPreview(URL.createObjectURL(file));\n  };\n  const handleRemoveImage = () => {\n    setImage(null);\n    setPreview(null);\n    if (fileRef.current) fileRef.current.value = '';\n  };\n  const handleSubmit = async text => {\n    const msg = text || input.trim();\n    if (!msg && !image) return;\n    const isImageSubmission = !!image;\n    setHasImage(isImageSubmission);\n    setStarted(true);\n    setLoading(true);\n    setPhase(0);\n\n    // Add user message\n    setMessages(prev => [...prev, {\n      role: 'user',\n      text: msg,\n      image: preview\n    }]);\n    setInput('');\n    setPreview(null);\n\n    // Add thinking message\n    const thinkingId = Date.now();\n    setMessages(prev => [...prev, {\n      role: 'thinking',\n      id: thinkingId\n    }]);\n\n    // Start API call immediately\n    const apiPromise = image ? submitWithImage(msg) : submitChatOnly(msg);\n\n    // Race: simulate steps, but resolve as soon as API responds\n    let apiDone = false;\n    let apiResult = null;\n    let apiError = null;\n\n    // Fire API and capture result\n    apiPromise.then(result => {\n      apiResult = result;\n    }).catch(err => {\n      apiError = err;\n    }).finally(() => {\n      apiDone = true;\n    });\n    const showResult = () => {\n      if (apiError) {\n        var _apiError, _apiError$response, _apiError$response$da, _apiError2, _apiError2$response, _apiError2$response$d;\n        const errorMessage = ((_apiError = apiError) === null || _apiError === void 0 ? void 0 : (_apiError$response = _apiError.response) === null || _apiError$response === void 0 ? void 0 : (_apiError$response$da = _apiError$response.data) === null || _apiError$response$da === void 0 ? void 0 : _apiError$response$da.reply) || ((_apiError2 = apiError) === null || _apiError2 === void 0 ? void 0 : (_apiError2$response = _apiError2.response) === null || _apiError2$response === void 0 ? void 0 : (_apiError2$response$d = _apiError2$response.data) === null || _apiError2$response$d === void 0 ? void 0 : _apiError2$response$d.message) || '‚ùå Something went wrong. Please try again.';\n        setMessages(prev => prev.map(m => m.id === thinkingId ? {\n          role: 'assistant',\n          text: errorMessage\n        } : m));\n      } else {\n        setMessages(prev => prev.map(m => m.id === thinkingId ? {\n          role: 'assistant',\n          text: apiResult || 'Done!'\n        } : m));\n      }\n      setLoading(false);\n      setPhase(-1);\n      setImage(null);\n      setHasImage(false);\n      setGpsCoords(null);\n    };\n\n    // Simulate steps; check each tick if API already responded\n    simulateSteps(() => {\n      // Steps animation done ‚Äî show result (API should be done by now)\n      if (apiDone) {\n        showResult();\n      } else {\n        // API still running ‚Äî wait for it\n        apiPromise.finally(() => showResult());\n      }\n    }, isImageSubmission);\n  };\n  const submitWithImage = async location => {\n    const fd = new FormData();\n    fd.append('image', image);\n    fd.append('location', location || 'Chennai');\n    if (gpsCoords) {\n      fd.append('lat', gpsCoords.lat);\n      fd.append('lng', gpsCoords.lng);\n    }\n    const {\n      data\n    } = await axios.post(`${BASE}/complaint`, fd, {\n      headers: {\n        'Content-Type': 'multipart/form-data'\n      }\n    });\n    setGpsCoords(null); // reset after submission\n    return data.message || 'Complaint submitted successfully!';\n  };\n  const submitChatOnly = async msg => {\n    const {\n      data\n    } = await axios.post(`${BASE}/chat`, {\n      message: msg,\n      session_id: 'public_portal_chat'\n    }, {\n      timeout: 30000\n    });\n    return data.reply || data.message || 'Received your message.';\n  };\n\n  // Welcome screen\n  if (!started) return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"max-w-2xl mx-auto px-4 py-16 flex flex-col\\r items-center text-center\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"w-16 h-16 rounded-2xl bg-gradient-to-br\\r from-blue-600 to-purple-600 flex items-center\\r justify-center text-3xl mb-6 shadow-lg\",\n      children: \"\\uD83C\\uDFD9\\uFE0F\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 264,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"h1\", {\n      className: \"text-3xl font-bold text-white mb-2\",\n      children: \"Report a Civic Issue\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 269,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n      className: \"text-zinc-400 mb-10 max-w-md\",\n      children: \"Take a photo or paste an image (Ctrl+V), share your location \\u2014 CiviqAI will analyze it and notify the right department automatically.\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 272,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"w-full max-w-xl\",\n      children: /*#__PURE__*/_jsxDEV(InputBar, {\n        input: input,\n        setInput: setInput,\n        image: image,\n        preview: preview,\n        fileRef: fileRef,\n        handleImage: handleImage,\n        handleRemoveImage: handleRemoveImage,\n        onSubmit: handleSubmit,\n        loading: loading,\n        onGps: handleGps,\n        gpsLoading: gpsLoading,\n        gpsCoords: gpsCoords\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 279,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 278,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex flex-wrap gap-2 justify-center mt-6\",\n      children: SUGGESTIONS.map(s => /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => handleSubmit(s),\n        className: \"px-4 py-2 bg-zinc-900 border border-white/10\\r rounded-full text-sm text-zinc-400\\r hover:border-white/30 hover:text-white\\r transition-all\",\n        children: s\n      }, s, false, {\n        fileName: _jsxFileName,\n        lineNumber: 298,\n        columnNumber: 11\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 296,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 262,\n    columnNumber: 5\n  }, this);\n\n  // Chat view\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"max-w-2xl mx-auto px-4 flex flex-col\\r h-[calc(100vh-65px)]\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex-1 overflow-y-auto py-6 space-y-8\",\n      children: [messages.map((m, i) => {\n        var _m$text, _m$text2;\n        return /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [m.role === 'user' && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"mb-6\",\n            children: [m.image && /*#__PURE__*/_jsxDEV(\"img\", {\n              src: m.image,\n              alt: \"uploaded\",\n              className: \"w-full max-h-56 object-cover\\r rounded-2xl mb-3 border border-white/10\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 327,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"h2\", {\n              className: \"text-2xl font-bold text-white leading-tight\",\n              children: m.text\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 331,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 325,\n            columnNumber: 15\n          }, this), m.role === 'thinking' && phase >= 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"bg-zinc-900 border border-white/10\\r rounded-2xl p-5\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex items-center gap-2 mb-4\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"w-4 h-4 border-2 border-zinc-600\\r border-t-blue-400 rounded-full animate-spin\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 342,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"text-sm font-medium text-zinc-400\",\n                children: hasImage ? 'CiviqAI is processing your complaint...' : 'CiviqAI is thinking...'\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 344,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 341,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(ThinkingSteps, {\n              steps: buildSteps(phase, hasImage)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 348,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 339,\n            columnNumber: 15\n          }, this), m.role === 'assistant' && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"space-y-3\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex items-center gap-2 mb-2\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"w-6 h-6 rounded-full bg-gradient-to-br\\r from-blue-500 to-purple-600 flex items-center\\r justify-center text-xs\",\n                children: \"\\uD83E\\uDD16\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 356,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"text-sm font-semibold text-white\",\n                children: \"CiviqAI\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 359,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 355,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"prose prose-invert text-zinc-200\\r text-base leading-relaxed max-w-none\",\n              children: /*#__PURE__*/_jsxDEV(\"p\", {\n                children: m.text\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 363,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 361,\n              columnNumber: 17\n            }, this), (_m$text = m.text) !== null && _m$text !== void 0 && _m$text.includes('submitted') || (_m$text2 = m.text) !== null && _m$text2 !== void 0 && _m$text2.includes('sent') ? /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"bg-green-500/10 border border-green-500/20\\r rounded-xl p-4 flex items-start gap-3\",\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"text-2xl\",\n                children: \"\\u2705\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 371,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                children: [/*#__PURE__*/_jsxDEV(\"p\", {\n                  className: \"text-green-400 font-semibold text-sm\",\n                  children: \"Complaint Submitted\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 373,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                  className: \"text-green-300/70 text-xs mt-0.5\",\n                  children: \"Your complaint is now live on the feed and the department has been notified.\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 376,\n                  columnNumber: 23\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 372,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 369,\n              columnNumber: 19\n            }, this) : null]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 354,\n            columnNumber: 15\n          }, this)]\n        }, i, true, {\n          fileName: _jsxFileName,\n          lineNumber: 321,\n          columnNumber: 11\n        }, this);\n      }), /*#__PURE__*/_jsxDEV(\"div\", {\n        ref: bottomRef\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 387,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 319,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"pb-4 pt-2 border-t border-white/10\",\n      children: /*#__PURE__*/_jsxDEV(InputBar, {\n        input: input,\n        setInput: setInput,\n        image: image,\n        preview: preview,\n        fileRef: fileRef,\n        handleImage: handleImage,\n        handleRemoveImage: handleRemoveImage,\n        onSubmit: handleSubmit,\n        loading: loading,\n        onGps: handleGps,\n        gpsLoading: gpsLoading,\n        gpsCoords: gpsCoords\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 392,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 391,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 315,\n    columnNumber: 5\n  }, this);\n}\n\n// ‚îÄ‚îÄ Shared Input Bar ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n_s(ReportPage, \"iW7lSzXvHnLUedXtauza+Aj3M1A=\");\n_c = ReportPage;\nfunction InputBar({\n  input,\n  setInput,\n  image,\n  preview,\n  fileRef,\n  handleImage,\n  handleRemoveImage,\n  onSubmit,\n  loading,\n  onGps,\n  gpsLoading,\n  gpsCoords\n}) {\n  const handleKey = e => {\n    if (e.key === 'Enter' && !e.shiftKey) {\n      e.preventDefault();\n      onSubmit(input);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"bg-zinc-900 border border-white/10 rounded-2xl\\r overflow-hidden focus-within:border-white/30\\r transition-colors\",\n    children: [gpsCoords && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"px-4 pt-3 flex items-center gap-2\",\n      children: /*#__PURE__*/_jsxDEV(\"span\", {\n        className: \"inline-flex items-center gap-1.5 px-3 py-1\\r bg-blue-500/15 border border-blue-500/30\\r rounded-full text-xs text-blue-400\",\n        children: [/*#__PURE__*/_jsxDEV(\"svg\", {\n          className: \"w-3.5 h-3.5\",\n          fill: \"currentColor\",\n          viewBox: \"0 0 24 24\",\n          children: /*#__PURE__*/_jsxDEV(\"path\", {\n            d: \"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5a2.5 2.5 0 010-5 2.5 2.5 0 010 5z\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 435,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 434,\n          columnNumber: 13\n        }, this), \"GPS: \", gpsCoords.lat.toFixed(4), \", \", gpsCoords.lng.toFixed(4)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 431,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 430,\n      columnNumber: 9\n    }, this), preview && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"px-4 pt-3\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"relative inline-block\",\n        children: [/*#__PURE__*/_jsxDEV(\"img\", {\n          src: preview,\n          alt: \"preview\",\n          className: \"h-20 w-32 object-cover rounded-xl\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 446,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: handleRemoveImage,\n          className: \"absolute -top-1 -right-1 w-5 h-5 bg-zinc-700\\r rounded-full flex items-center justify-center\\r text-xs hover:bg-red-600 transition-colors\",\n          children: \"\\u2715\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 448,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 445,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 444,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex items-end gap-2 px-4 py-3\",\n      children: [/*#__PURE__*/_jsxDEV(\"textarea\", {\n        value: input,\n        onChange: e => setInput(e.target.value),\n        onKeyDown: handleKey,\n        placeholder: gpsCoords ? \"Location detected ‚Äî add description...\" : preview ? \"Add location or description...\" : \"Describe the issue or paste an image (Ctrl+V)...\",\n        rows: 1,\n        className: \"flex-1 bg-transparent text-white text-sm\\r placeholder:text-zinc-600 resize-none focus:outline-none\\r max-h-32 overflow-y-auto\",\n        style: {\n          fieldSizing: 'content'\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 461,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex items-center gap-2 flex-shrink-0\",\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: onGps,\n          disabled: gpsLoading,\n          className: `w-8 h-8 rounded-full flex items-center justify-center\n                       transition-colors ${gpsCoords ? 'text-blue-400 bg-blue-500/15' : 'text-zinc-500 hover:text-white hover:bg-white/10'}`,\n          title: \"Use my current location\",\n          children: gpsLoading ? /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"w-4 h-4 border-2 border-zinc-600\\r border-t-blue-400 rounded-full animate-spin\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 487,\n            columnNumber: 17\n          }, this) : /*#__PURE__*/_jsxDEV(\"svg\", {\n            className: \"w-5 h-5\",\n            fill: \"none\",\n            stroke: \"currentColor\",\n            viewBox: \"0 0 24 24\",\n            children: /*#__PURE__*/_jsxDEV(\"path\", {\n              strokeLinecap: \"round\",\n              strokeLinejoin: \"round\",\n              strokeWidth: 1.5,\n              d: \"M12 2a7 7 0 00-7 7c0 5.25 7 13 7 13s7-7.75 7-13a7 7 0 00-7-7zm0 9.5a2.5 2.5 0 110-5 2.5 2.5 0 010 5z\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 491,\n              columnNumber: 19\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 489,\n            columnNumber: 17\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 477,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => fileRef.current.click(),\n          className: \"w-8 h-8 rounded-full flex items-center justify-center\\r text-zinc-500 hover:text-white hover:bg-white/10\\r transition-colors\",\n          title: \"Attach photo (or paste with Ctrl+V)\",\n          children: /*#__PURE__*/_jsxDEV(\"svg\", {\n            className: \"w-5 h-5\",\n            fill: \"none\",\n            stroke: \"currentColor\",\n            viewBox: \"0 0 24 24\",\n            children: /*#__PURE__*/_jsxDEV(\"path\", {\n              strokeLinecap: \"round\",\n              strokeLinejoin: \"round\",\n              strokeWidth: 1.5,\n              d: \"M15.172 7l-6.586 6.586a2 2 0 102.828 2.828l6.414-6.586a4 4 0 00-5.656-5.656l-6.415 6.585a6 6 0 108.486 8.486L20.5 13\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 508,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 506,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 499,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          ref: fileRef,\n          type: \"file\",\n          accept: \"image/*\",\n          className: \"hidden\",\n          onChange: handleImage\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 513,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => onSubmit(input),\n          disabled: loading || !input.trim() && !image,\n          className: \"w-8 h-8 rounded-full bg-white flex items-center\\r justify-center disabled:opacity-30 disabled:cursor-not-allowed\\r hover:bg-zinc-200 transition-colors\",\n          children: loading ? /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"w-4 h-4 border-2 border-zinc-400\\r border-t-zinc-800 rounded-full animate-spin\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 525,\n            columnNumber: 17\n          }, this) : /*#__PURE__*/_jsxDEV(\"svg\", {\n            className: \"w-4 h-4 text-black\",\n            fill: \"none\",\n            stroke: \"currentColor\",\n            viewBox: \"0 0 24 24\",\n            children: /*#__PURE__*/_jsxDEV(\"path\", {\n              strokeLinecap: \"round\",\n              strokeLinejoin: \"round\",\n              strokeWidth: 2,\n              d: \"M5 12h14M12 5l7 7-7 7\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 529,\n              columnNumber: 19\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 527,\n            columnNumber: 17\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 517,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 474,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 460,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 424,\n    columnNumber: 5\n  }, this);\n}\n_c2 = InputBar;\nvar _c, _c2;\n$RefreshReg$(_c, \"ReportPage\");\n$RefreshReg$(_c2, \"InputBar\");","map":{"version":3,"names":["useState","useRef","useEffect","useCallback","axios","ThinkingSteps","jsxDEV","_jsxDEV","BASE","process","env","REACT_APP_API_URL","buildSteps","phase","hasImage","imageSteps","id","label","detail","chatSteps","all","map","s","i","active","status","SUGGESTIONS","ReportPage","_s","messages","setMessages","input","setInput","image","setImage","preview","setPreview","loading","setLoading","setPhase","started","setStarted","setHasImage","gpsCoords","setGpsCoords","gpsLoading","setGpsLoading","bottomRef","fileRef","timerRef","_bottomRef$current","current","scrollIntoView","behavior","handlePaste","e","_e$clipboardData","items","clipboardData","item","type","startsWith","preventDefault","file","getAsFile","URL","createObjectURL","document","addEventListener","removeEventListener","simulateSteps","onDone","isImageSubmission","step","maxSteps","setInterval","clearInterval","handleGps","navigator","geolocation","alert","getCurrentPosition","pos","latitude","longitude","coords","lat","lng","data","get","addr","formatted_address","area","prev","toFixed","err","console","error","enableHighAccuracy","timeout","handleImage","target","files","handleRemoveImage","value","handleSubmit","text","msg","trim","role","thinkingId","Date","now","apiPromise","submitWithImage","submitChatOnly","apiDone","apiResult","apiError","then","result","catch","finally","showResult","_apiError","_apiError$response","_apiError$response$da","_apiError2","_apiError2$response","_apiError2$response$d","errorMessage","response","reply","message","m","location","fd","FormData","append","post","headers","session_id","className","children","fileName","_jsxFileName","lineNumber","columnNumber","InputBar","onSubmit","onGps","onClick","_m$text","_m$text2","src","alt","steps","includes","ref","_c","handleKey","key","shiftKey","fill","viewBox","d","onChange","onKeyDown","placeholder","rows","style","fieldSizing","disabled","title","stroke","strokeLinecap","strokeLinejoin","strokeWidth","click","accept","_c2","$RefreshReg$"],"sources":["C:/Users/NISHANTH MEGAN/civiqai/frontend/public-portal/src/pages/ReportPage.jsx"],"sourcesContent":["import { useState, useRef, useEffect, useCallback } from 'react';\r\nimport axios from 'axios';\r\nimport ThinkingSteps from '../components/ThinkingSteps';\r\n\r\nconst BASE = process.env.REACT_APP_API_URL || 'http://localhost:8080';\r\n\r\n// Simulates the agent pipeline steps in real time\r\nfunction buildSteps(phase, hasImage) {\r\n  const imageSteps = [\r\n    { id: 'analyze',  label: 'Analyzing image with Gemini Vision',\r\n      detail: 'Identifying issue type, severity and road condition' },\r\n    { id: 'locate',   label: 'Geocoding location',\r\n      detail: 'Converting address to coordinates via Maps API' },\r\n    { id: 'ward',     label: 'Finding municipal ward',\r\n      detail: 'Reverse geocoding to get ward and zone' },\r\n    { id: 'search',   label: 'Searching municipal directory',\r\n      detail: 'Looking up responsible officer in Redis' },\r\n    { id: 'cluster',  label: 'Checking nearby complaints',\r\n      detail: 'Scanning 500m radius for similar issues' },\r\n    { id: 'dispatch', label: 'Sending work order email',\r\n      detail: 'Dispatching to municipal department' },\r\n    { id: 'publish',  label: 'Publishing to public feed',\r\n      detail: 'Posting complaint on the portal' },\r\n  ];\r\n\r\n  const chatSteps = [\r\n    { id: 'processing', label: 'Processing your query',\r\n      detail: 'Understanding your question' },\r\n    { id: 'search',   label: 'Searching complaint database',\r\n      detail: 'Looking up relevant data' },\r\n    { id: 'analyze',  label: 'Analyzing trends and patterns',\r\n      detail: 'Generating insights' },\r\n    { id: 'respond',  label: 'Preparing response',\r\n      detail: 'Formatting answer for you' },\r\n  ];\r\n\r\n  const all = hasImage ? imageSteps : chatSteps;\r\n\r\n  return all.map((s, i) => ({\r\n    ...s,\r\n    active: i <= phase,\r\n    status: i < phase  ? 'done'\r\n          : i === phase ? 'running'\r\n          : 'analyzing'\r\n  }));\r\n}\r\n\r\nconst SUGGESTIONS = [\r\n  'üöß Report a pothole',\r\n  'üíß Water pipe leaking',\r\n  'üóëÔ∏è Garbage not collected',\r\n  'üí° Streetlight not working',\r\n  'üåä Waterlogging issue',\r\n];\r\n\r\nexport default function ReportPage() {\r\n  const [messages, setMessages] = useState([]);\r\n  const [input,    setInput]    = useState('');\r\n  const [image,    setImage]    = useState(null);\r\n  const [preview,  setPreview]  = useState(null);\r\n  const [loading,  setLoading]  = useState(false);\r\n  const [phase,    setPhase]    = useState(-1);\r\n  const [started,  setStarted]  = useState(false);\r\n  const [hasImage, setHasImage] = useState(false);\r\n  const [gpsCoords, setGpsCoords] = useState(null);   // {lat, lng}\r\n  const [gpsLoading, setGpsLoading] = useState(false);\r\n  const bottomRef  = useRef(null);\r\n  const fileRef    = useRef(null);\r\n  const timerRef   = useRef(null);\r\n\r\n  useEffect(() => {\r\n    bottomRef.current?.scrollIntoView({ behavior: 'smooth' });\r\n  }, [messages, phase]);\r\n\r\n  // Handle paste event to capture images from clipboard\r\n  useEffect(() => {\r\n    const handlePaste = (e) => {\r\n      const items = e.clipboardData?.items;\r\n      if (!items) return;\r\n\r\n      for (const item of items) {\r\n        if (item.type.startsWith('image/')) {\r\n          e.preventDefault();\r\n          const file = item.getAsFile();\r\n          if (file) {\r\n            setImage(file);\r\n            setPreview(URL.createObjectURL(file));\r\n          }\r\n          break;\r\n        }\r\n      }\r\n    };\r\n\r\n    document.addEventListener('paste', handlePaste);\r\n    return () => document.removeEventListener('paste', handlePaste);\r\n  }, []);\r\n\r\n  // Simulate step-by-step agent progress\r\n  const simulateSteps = useCallback((onDone, isImageSubmission) => {\r\n    let step = 0;\r\n    const maxSteps = isImageSubmission ? 7 : 4;\r\n    setPhase(0);\r\n    timerRef.current = setInterval(() => {\r\n      step++;\r\n      if (step >= maxSteps) {\r\n        clearInterval(timerRef.current);\r\n        setPhase(maxSteps + 1); // all done\r\n        onDone();\r\n      } else {\r\n        setPhase(step);\r\n      }\r\n    }, 1400);\r\n  }, []);\r\n\r\n  // ‚îÄ‚îÄ GPS: Get current location ‚îÄ‚îÄ\r\n  const handleGps = useCallback(() => {\r\n    if (!navigator.geolocation) {\r\n      alert('Geolocation is not supported by your browser');\r\n      return;\r\n    }\r\n    setGpsLoading(true);\r\n    navigator.geolocation.getCurrentPosition(\r\n      async (pos) => {\r\n        const { latitude, longitude } = pos.coords;\r\n        setGpsCoords({ lat: latitude, lng: longitude });\r\n        try {\r\n          const { data } = await axios.get(\r\n            `${BASE}/reverse-geocode?lat=${latitude}&lng=${longitude}`\r\n          );\r\n          const addr = data.formatted_address || data.area || `${latitude}, ${longitude}`;\r\n          setInput(prev => prev ? prev : addr);\r\n        } catch {\r\n          setInput(`${latitude.toFixed(6)}, ${longitude.toFixed(6)}`);\r\n        }\r\n        setGpsLoading(false);\r\n      },\r\n      (err) => {\r\n        console.error('GPS error', err);\r\n        alert('Could not get your location. Please allow location access.');\r\n        setGpsLoading(false);\r\n      },\r\n      { enableHighAccuracy: true, timeout: 10000 }\r\n    );\r\n  }, []);\r\n\r\n  const handleImage = (e) => {\r\n    const file = e.target.files[0];\r\n    if (!file) return;\r\n    setImage(file);\r\n    setPreview(URL.createObjectURL(file));\r\n  };\r\n\r\n  const handleRemoveImage = () => {\r\n    setImage(null);\r\n    setPreview(null);\r\n    if (fileRef.current) fileRef.current.value = '';\r\n  };\r\n\r\n  const handleSubmit = async (text) => {\r\n    const msg = text || input.trim();\r\n    if (!msg && !image) return;\r\n\r\n    const isImageSubmission = !!image;\r\n    setHasImage(isImageSubmission);\r\n    setStarted(true);\r\n    setLoading(true);\r\n    setPhase(0);\r\n\r\n    // Add user message\r\n    setMessages(prev => [...prev, {\r\n      role:    'user',\r\n      text:    msg,\r\n      image:   preview\r\n    }]);\r\n    setInput('');\r\n    setPreview(null);\r\n\r\n    // Add thinking message\r\n    const thinkingId = Date.now();\r\n    setMessages(prev => [...prev, {\r\n      role: 'thinking',\r\n      id:   thinkingId\r\n    }]);\r\n\r\n    // Start API call immediately\r\n    const apiPromise = image\r\n      ? submitWithImage(msg)\r\n      : submitChatOnly(msg);\r\n\r\n    // Race: simulate steps, but resolve as soon as API responds\r\n    let apiDone = false;\r\n    let apiResult = null;\r\n    let apiError = null;\r\n\r\n    // Fire API and capture result\r\n    apiPromise\r\n      .then(result => { apiResult = result; })\r\n      .catch(err => { apiError = err; })\r\n      .finally(() => { apiDone = true; });\r\n\r\n    const showResult = () => {\r\n      if (apiError) {\r\n        const errorMessage = apiError?.response?.data?.reply\r\n          || apiError?.response?.data?.message\r\n          || '‚ùå Something went wrong. Please try again.';\r\n        setMessages(prev => prev.map(m =>\r\n          m.id === thinkingId\r\n            ? { role: 'assistant', text: errorMessage }\r\n            : m\r\n        ));\r\n      } else {\r\n        setMessages(prev => prev.map(m =>\r\n          m.id === thinkingId\r\n            ? { role: 'assistant', text: apiResult || 'Done!' }\r\n            : m\r\n        ));\r\n      }\r\n      setLoading(false);\r\n      setPhase(-1);\r\n      setImage(null);\r\n      setHasImage(false);\r\n      setGpsCoords(null);\r\n    };\r\n\r\n    // Simulate steps; check each tick if API already responded\r\n    simulateSteps(() => {\r\n      // Steps animation done ‚Äî show result (API should be done by now)\r\n      if (apiDone) {\r\n        showResult();\r\n      } else {\r\n        // API still running ‚Äî wait for it\r\n        apiPromise.finally(() => showResult());\r\n      }\r\n    }, isImageSubmission);\r\n  };\r\n\r\n  const submitWithImage = async (location) => {\r\n    const fd = new FormData();\r\n    fd.append('image',    image);\r\n    fd.append('location', location || 'Chennai');\r\n    if (gpsCoords) {\r\n      fd.append('lat', gpsCoords.lat);\r\n      fd.append('lng', gpsCoords.lng);\r\n    }\r\n    const { data } = await axios.post(`${BASE}/complaint`, fd, {\r\n      headers: { 'Content-Type': 'multipart/form-data' }\r\n    });\r\n    setGpsCoords(null);  // reset after submission\r\n    return data.message || 'Complaint submitted successfully!';\r\n  };\r\n\r\n  const submitChatOnly = async (msg) => {\r\n    const { data } = await axios.post(`${BASE}/chat`, {\r\n      message: msg,\r\n      session_id: 'public_portal_chat'\r\n    }, { timeout: 30000 });\r\n    return data.reply || data.message || 'Received your message.';\r\n  };\r\n\r\n  // Welcome screen\r\n  if (!started) return (\r\n    <div className=\"max-w-2xl mx-auto px-4 py-16 flex flex-col\r\n                    items-center text-center\">\r\n      <div className=\"w-16 h-16 rounded-2xl bg-gradient-to-br\r\n                      from-blue-600 to-purple-600 flex items-center\r\n                      justify-center text-3xl mb-6 shadow-lg\">\r\n        üèôÔ∏è\r\n      </div>\r\n      <h1 className=\"text-3xl font-bold text-white mb-2\">\r\n        Report a Civic Issue\r\n      </h1>\r\n      <p className=\"text-zinc-400 mb-10 max-w-md\">\r\n        Take a photo or paste an image (Ctrl+V), share your location ‚Äî \r\n        CiviqAI will analyze it and notify the right department automatically.\r\n      </p>\r\n\r\n      {/* Main input */}\r\n      <div className=\"w-full max-w-xl\">\r\n        <InputBar\r\n          input={input}\r\n          setInput={setInput}\r\n          image={image}\r\n          preview={preview}\r\n          fileRef={fileRef}\r\n          handleImage={handleImage}\r\n          handleRemoveImage={handleRemoveImage}\r\n          onSubmit={handleSubmit}\r\n          loading={loading}\r\n          onGps={handleGps}\r\n          gpsLoading={gpsLoading}\r\n          gpsCoords={gpsCoords}\r\n        />\r\n      </div>\r\n\r\n      {/* Suggestions */}\r\n      <div className=\"flex flex-wrap gap-2 justify-center mt-6\">\r\n        {SUGGESTIONS.map(s => (\r\n          <button\r\n            key={s}\r\n            onClick={() => handleSubmit(s)}\r\n            className=\"px-4 py-2 bg-zinc-900 border border-white/10\r\n                       rounded-full text-sm text-zinc-400\r\n                       hover:border-white/30 hover:text-white\r\n                       transition-all\"\r\n          >\r\n            {s}\r\n          </button>\r\n        ))}\r\n      </div>\r\n    </div>\r\n  );\r\n\r\n  // Chat view\r\n  return (\r\n    <div className=\"max-w-2xl mx-auto px-4 flex flex-col\r\n                    h-[calc(100vh-65px)]\">\r\n\r\n      {/* Messages */}\r\n      <div className=\"flex-1 overflow-y-auto py-6 space-y-8\">\r\n        {messages.map((m, i) => (\r\n          <div key={i}>\r\n\r\n            {/* User message */}\r\n            {m.role === 'user' && (\r\n              <div className=\"mb-6\">\r\n                {m.image && (\r\n                  <img src={m.image} alt=\"uploaded\"\r\n                       className=\"w-full max-h-56 object-cover\r\n                                  rounded-2xl mb-3 border border-white/10\"/>\r\n                )}\r\n                <h2 className=\"text-2xl font-bold text-white leading-tight\">\r\n                  {m.text}\r\n                </h2>\r\n              </div>\r\n            )}\r\n\r\n            {/* Thinking / Processing */}\r\n            {m.role === 'thinking' && phase >= 0 && (\r\n              <div className=\"bg-zinc-900 border border-white/10\r\n                              rounded-2xl p-5\">\r\n                <div className=\"flex items-center gap-2 mb-4\">\r\n                  <div className=\"w-4 h-4 border-2 border-zinc-600\r\n                                  border-t-blue-400 rounded-full animate-spin\"/>\r\n                  <span className=\"text-sm font-medium text-zinc-400\">\r\n                    {hasImage ? 'CiviqAI is processing your complaint...' : 'CiviqAI is thinking...'}\r\n                  </span>\r\n                </div>\r\n                <ThinkingSteps steps={buildSteps(phase, hasImage)} />\r\n              </div>\r\n            )}\r\n\r\n            {/* Assistant response */}\r\n            {m.role === 'assistant' && (\r\n              <div className=\"space-y-3\">\r\n                <div className=\"flex items-center gap-2 mb-2\">\r\n                  <div className=\"w-6 h-6 rounded-full bg-gradient-to-br\r\n                                  from-blue-500 to-purple-600 flex items-center\r\n                                  justify-center text-xs\">ü§ñ</div>\r\n                  <span className=\"text-sm font-semibold text-white\">CiviqAI</span>\r\n                </div>\r\n                <div className=\"prose prose-invert text-zinc-200\r\n                                text-base leading-relaxed max-w-none\">\r\n                  <p>{m.text}</p>\r\n                </div>\r\n\r\n                {/* Success card */}\r\n                {m.text?.includes('submitted') ||\r\n                 m.text?.includes('sent') ? (\r\n                  <div className=\"bg-green-500/10 border border-green-500/20\r\n                                  rounded-xl p-4 flex items-start gap-3\">\r\n                    <span className=\"text-2xl\">‚úÖ</span>\r\n                    <div>\r\n                      <p className=\"text-green-400 font-semibold text-sm\">\r\n                        Complaint Submitted\r\n                      </p>\r\n                      <p className=\"text-green-300/70 text-xs mt-0.5\">\r\n                        Your complaint is now live on the feed and the\r\n                        department has been notified.\r\n                      </p>\r\n                    </div>\r\n                  </div>\r\n                ) : null}\r\n              </div>\r\n            )}\r\n          </div>\r\n        ))}\r\n        <div ref={bottomRef} />\r\n      </div>\r\n\r\n      {/* Sticky input */}\r\n      <div className=\"pb-4 pt-2 border-t border-white/10\">\r\n        <InputBar\r\n          input={input}\r\n          setInput={setInput}\r\n          image={image}\r\n          preview={preview}\r\n          fileRef={fileRef}\r\n          handleImage={handleImage}\r\n          handleRemoveImage={handleRemoveImage}\r\n          onSubmit={handleSubmit}\r\n          loading={loading}\r\n          onGps={handleGps}\r\n          gpsLoading={gpsLoading}\r\n          gpsCoords={gpsCoords}\r\n        />\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n// ‚îÄ‚îÄ Shared Input Bar ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\r\nfunction InputBar({ input, setInput, image, preview, fileRef,\r\n                    handleImage, handleRemoveImage, onSubmit, loading,\r\n                    onGps, gpsLoading, gpsCoords }) {\r\n\r\n  const handleKey = (e) => {\r\n    if (e.key === 'Enter' && !e.shiftKey) {\r\n      e.preventDefault();\r\n      onSubmit(input);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"bg-zinc-900 border border-white/10 rounded-2xl\r\n                    overflow-hidden focus-within:border-white/30\r\n                    transition-colors\">\r\n\r\n      {/* GPS location badge */}\r\n      {gpsCoords && (\r\n        <div className=\"px-4 pt-3 flex items-center gap-2\">\r\n          <span className=\"inline-flex items-center gap-1.5 px-3 py-1\r\n                           bg-blue-500/15 border border-blue-500/30\r\n                           rounded-full text-xs text-blue-400\">\r\n            <svg className=\"w-3.5 h-3.5\" fill=\"currentColor\" viewBox=\"0 0 24 24\">\r\n              <path d=\"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5a2.5 2.5 0 010-5 2.5 2.5 0 010 5z\"/>\r\n            </svg>\r\n            GPS: {gpsCoords.lat.toFixed(4)}, {gpsCoords.lng.toFixed(4)}\r\n          </span>\r\n        </div>\r\n      )}\r\n\r\n      {/* Image preview strip */}\r\n      {preview && (\r\n        <div className=\"px-4 pt-3\">\r\n          <div className=\"relative inline-block\">\r\n            <img src={preview} alt=\"preview\"\r\n                 className=\"h-20 w-32 object-cover rounded-xl\"/>\r\n            <button\r\n              onClick={handleRemoveImage}\r\n              className=\"absolute -top-1 -right-1 w-5 h-5 bg-zinc-700\r\n                         rounded-full flex items-center justify-center\r\n                         text-xs hover:bg-red-600 transition-colors\">\r\n              ‚úï\r\n            </button>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Text input */}\r\n      <div className=\"flex items-end gap-2 px-4 py-3\">\r\n        <textarea\r\n          value={input}\r\n          onChange={e => setInput(e.target.value)}\r\n          onKeyDown={handleKey}\r\n          placeholder={gpsCoords ? \"Location detected ‚Äî add description...\" : preview ? \"Add location or description...\" : \"Describe the issue or paste an image (Ctrl+V)...\"}\r\n          rows={1}\r\n          className=\"flex-1 bg-transparent text-white text-sm\r\n                     placeholder:text-zinc-600 resize-none focus:outline-none\r\n                     max-h-32 overflow-y-auto\"\r\n          style={{ fieldSizing: 'content' }}\r\n        />\r\n\r\n        {/* Action buttons */}\r\n        <div className=\"flex items-center gap-2 flex-shrink-0\">\r\n\r\n          {/* GPS location */}\r\n          <button\r\n            onClick={onGps}\r\n            disabled={gpsLoading}\r\n            className={`w-8 h-8 rounded-full flex items-center justify-center\r\n                       transition-colors ${gpsCoords\r\n                         ? 'text-blue-400 bg-blue-500/15'\r\n                         : 'text-zinc-500 hover:text-white hover:bg-white/10'}`}\r\n            title=\"Use my current location\"\r\n          >\r\n            {gpsLoading\r\n              ? <div className=\"w-4 h-4 border-2 border-zinc-600\r\n                                border-t-blue-400 rounded-full animate-spin\"/>\r\n              : <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\"\r\n                     viewBox=\"0 0 24 24\">\r\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\"\r\n                        strokeWidth={1.5}\r\n                        d=\"M12 2a7 7 0 00-7 7c0 5.25 7 13 7 13s7-7.75 7-13a7 7 0 00-7-7zm0 9.5a2.5 2.5 0 110-5 2.5 2.5 0 010 5z\"/>\r\n                </svg>\r\n            }\r\n          </button>\r\n\r\n          {/* Attach photo */}\r\n          <button\r\n            onClick={() => fileRef.current.click()}\r\n            className=\"w-8 h-8 rounded-full flex items-center justify-center\r\n                       text-zinc-500 hover:text-white hover:bg-white/10\r\n                       transition-colors\"\r\n            title=\"Attach photo (or paste with Ctrl+V)\"\r\n          >\r\n            <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\"\r\n                 viewBox=\"0 0 24 24\">\r\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\"\r\n                    strokeWidth={1.5}\r\n                    d=\"M15.172 7l-6.586 6.586a2 2 0 102.828 2.828l6.414-6.586a4 4 0 00-5.656-5.656l-6.415 6.585a6 6 0 108.486 8.486L20.5 13\"/>\r\n            </svg>\r\n          </button>\r\n          <input ref={fileRef} type=\"file\" accept=\"image/*\"\r\n                 className=\"hidden\" onChange={handleImage} />\r\n\r\n          {/* Submit */}\r\n          <button\r\n            onClick={() => onSubmit(input)}\r\n            disabled={loading || (!input.trim() && !image)}\r\n            className=\"w-8 h-8 rounded-full bg-white flex items-center\r\n                       justify-center disabled:opacity-30 disabled:cursor-not-allowed\r\n                       hover:bg-zinc-200 transition-colors\"\r\n          >\r\n            {loading\r\n              ? <div className=\"w-4 h-4 border-2 border-zinc-400\r\n                                border-t-zinc-800 rounded-full animate-spin\"/>\r\n              : <svg className=\"w-4 h-4 text-black\" fill=\"none\"\r\n                     stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\"\r\n                        strokeWidth={2} d=\"M5 12h14M12 5l7 7-7 7\"/>\r\n                </svg>\r\n            }\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}